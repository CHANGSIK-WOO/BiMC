SEED: 1

DEVICE:
  DEVICE_NAME: "cuda"
  GPU_ID: "0;"

DATALOADER:
  TRAIN:
    BATCH_SIZE_BASE: 16  # Normal batch size for evaluation
    BATCH_SIZE_INC: 16   # Normal batch size for evaluation
  TEST:
    BATCH_SIZE: 16      # Normal batch size for evaluation
  NUM_WORKERS: 4


MODEL:
  BACKBONE:
    NAME: "ViT-B/16"  #  RN50  RN101  ViT-B/32  ViT-B/16  ViT-L/14


TRAINER:
  BiMC:
    METHOD: "edge_meta"  # Meta-learning version of edge
    PREC: "fp32"  # fp16, fp32, amp

    VISION_CALIBRATION: True
    LAMBDA_I: 0.1
    TAU: 16

    TEXT_CALIBRATION: True
    LAMBDA_T: 0.5

    GAMMA_BASE: 1.0
    GAMMA_INC: 5.0

    # EDGE specific parameters (these will be predicted by router)
    EDGE:
      GAMMA: 0.5  # Default value (will be overridden by router)
      INFERENCE_EDGE: False  # Extract edge features during inference

    # Meta-learning specific parameters
    META:
      ENABLED: True
      NUM_EPISODES: 50  # Number of meta-training episodes
      INNER_LR: 0.01     # Learning rate for inner loop
      OUTER_LR: 0.1    # Learning rate for outer loop (router parameters)
      INNER_STEPS: 3     # Number of inner loop gradient steps per support domain
      SUPPORT_SHOT: 4    # Number of samples for prototype in inner loop
      QUERY_SHOT: 1      # Number of samples for loss computation
      ROUTER_HIDDEN_DIM: 256  # Hidden dimension for router network
      BATCH_SIZE: 16     # Small batch size for meta-learning only

    # EDGE always uses ensemble (same condition as bimc_ensemble baseline)
    USING_ENSEMBLE: False
