SEED: 1

DEVICE:
  DEVICE_NAME: "cuda"
  GPU_ID: "0;"

DATALOADER:
  TRAIN:
    BATCH_SIZE_BASE: 64
    BATCH_SIZE_INC: 64
  TEST:
    BATCH_SIZE: 100
  NUM_WORKERS: 4


MODEL:
  BACKBONE:
    NAME: "ViT-B/16"  #  RN50  RN101  ViT-B/32  ViT-B/16  ViT-L/14


TRAINER:
  BiMC:
    METHOD: "edge"  # bimc, bimc_ensemble, edge
    PREC: "fp32"  # fp16, fp32, amp

    VISION_CALIBRATION: True
    LAMBDA_I: 0.1
    TAU: 16

    TEXT_CALIBRATION: True
    LAMBDA_T: 0.5

    GAMMA_BASE: 1.0
    GAMMA_INC: 5.0

    # Meta-learning flag
    META_LEARNING: True

    # Meta-learning parameters
    META:
      # Stage 1: Class-level meta-learning on Real domain
      STAGE1_EPISODES: 1000
      STAGE1_N_WAY: 5
      STAGE1_K_SHOT: 5
      STAGE1_QUERY: 15

      # Stage 2: Cross-domain meta-learning with LODO
      STAGE2_EPISODES: 500
      STAGE2_N_WAY: 5
      STAGE2_K_SHOT: 5
      STAGE2_QUERY: 15

      # Learning rates
      INNER_LR: 0.01  # Inner loop learning rate (task adaptation)
      META_LR: 0.001  # Outer loop learning rate (meta-update)

      # MAML settings
      INNER_STEPS: 5  # Number of inner loop gradient steps
      FIRST_ORDER: False  # Use first-order MAML approximation

    # EDGE specific parameters
    EDGE:
      GAMMA: 0.5  # Edge feature fusion weight (initial value, will be learned)
      SIGMA: 1.0  # Gaussian blur sigma (initial value, will be learned)
      INFERENCE_EDGE: False  # Extract edge features during inference

    # EDGE always uses ensemble (same condition as bimc_ensemble baseline)
    USING_ENSEMBLE: False
